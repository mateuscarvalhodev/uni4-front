<section class="page">
  <header class="page__header">
    <h2>{{ isEdit() ? 'Editar disciplina' : 'Nova disciplina' }}</h2>
    <a class="btn btn--ghost" routerLink="/app/disciplinas">Voltar</a>
  </header>

  <div class="card">
    <form [formGroup]="form" (ngSubmit)="save()" class="form" novalidate>
      <div class="grid">
        <div class="field">
          <label for="name">Nome</label>
          <input
            id="name"
            type="text"
            formControlName="name"
            placeholder="Ex.: Software Engineering II"
            [attr.aria-invalid]="form.controls.name.invalid && form.controls.name.touched"
            [attr.aria-describedby]="form.controls.name.invalid ? 'name-err' : null"
            required
          />
          @if (form.controls.name.touched && form.controls.name.invalid) {
          <div id="name-err" class="err">Informe o nome.</div>
          }
        </div>

        <div class="field">
          <label for="hours">Carga horária (h)</label>
          <input
            id="hours"
            type="number"
            formControlName="hours"
            min="1"
            placeholder="Ex.: 100"
            [attr.aria-invalid]="form.controls.hours.invalid && form.controls.hours.touched"
            [attr.aria-describedby]="form.controls.hours.invalid ? 'hours-err' : null"
            required
          />
          @if (form.controls.hours.touched && form.controls.hours.invalid) {
          <div id="hours-err" class="err">Informe um valor ≥ 1.</div>
          }
        </div>

        <div class="field">
          <label for="semesterId">Semestre</label>
          <select
            id="semesterId"
            formControlName="semesterId"
            [attr.aria-invalid]="
              form.controls.semesterId.invalid && form.controls.semesterId.touched
            "
            [attr.aria-describedby]="form.controls.semesterId.invalid ? 'sem-err' : null"
            required
          >
            <option [ngValue]="null" disabled>Selecione...</option>
            @for (s of semesters(); track s.id) {
            <option [value]="s.id">Semestre {{ s.number }} (ID {{ s.id }})</option>
            }
          </select>
          @if (form.controls.semesterId.touched && form.controls.semesterId.invalid) {
          <div id="sem-err" class="err">Selecione um semestre.</div>
          }
        </div>
      </div>

      <div class="field">
        <label for="description">Descrição</label>
        <input
          id="description"
          type="text"
          formControlName="description"
          placeholder="Ex.: Advanced concepts in software architecture and design patterns"
          [attr.aria-invalid]="
            form.controls.description.invalid && form.controls.description.touched
          "
          [attr.aria-describedby]="form.controls.description.invalid ? 'desc-err' : null"
          required
        />

        @if (form.controls.description.touched && form.controls.description.invalid) {
        <div id="desc-err" class="err">Informe uma descrição.</div>
        }
      </div>

      <div class="actions">
        <a class="btn btn--ghost" routerLink="/app/disciplinas">Cancelar</a>
        <button class="btn btn--primary" [disabled]="form.invalid">
          {{ isEdit() ? 'Salvar alterações' : 'Criar disciplina' }}
        </button>
      </div>
    </form>
  </div>
</section>
